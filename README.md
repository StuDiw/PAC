# PAC
Material concerning Passive Aggressive Classifier (PAC)

This is an attempt to get through the math shown in
http://jmlr.csail.mit.edu/papers/volume7/crammer06a/crammer06a.pdf step by step.

File 'SimplePACImplementation191125.py' shows an static implementation of how PAC calculates an optimal margin for 2 data points.

The following shows thoughts concerning 
modification of weight vector <a href="https://www.codecogs.com/eqnedit.php?latex=\overrightarrow{w}" target="_blank"><img src="https://latex.codecogs.com/svg.latex?\overrightarrow{w}" title="\overrightarrow{w}" /></a> using loss function  <a href="https://www.codecogs.com/eqnedit.php?latex=\textit{l}" target="_blank"><img src="https://latex.codecogs.com/svg.latex?\textit{l}" title="\textit{l}" /></a>.<br>
Given:
<a href="https://www.codecogs.com/eqnedit.php?latex=\mathit{l}(\overrightarrow{w};(\overrightarrow{x},y))=&space;\begin{cases}&space;&&space;\text{0&space;for&space;}&space;y(\overrightarrow{w}\cdot&space;\overrightarrow{x}&space;)\geq&space;1&space;\\&space;&&space;1-y(\overrightarrow{w}\cdot&space;\overrightarrow{x})\text{&space;otherwise&space;}&space;\end{cases}" target="_blank"><img src="https://latex.codecogs.com/svg.latex?\mathit{l}(\overrightarrow{w};(\overrightarrow{x},y))=&space;\begin{cases}&space;&&space;\text{0&space;for&space;}&space;y(\overrightarrow{w}\cdot&space;\overrightarrow{x}&space;)\geq&space;1&space;\\&space;&&space;1-y(\overrightarrow{w}\cdot&space;\overrightarrow{x})\text{&space;otherwise&space;}&space;\end{cases}" title="\mathit{l}(\overrightarrow{w};(\overrightarrow{x},y))= \begin{cases} & \text{0 for } y(\overrightarrow{w}\cdot \overrightarrow{x} )\geq 1 \\ & 1-y(\overrightarrow{w}\cdot \overrightarrow{x})\text{ otherwise } \end{cases}" /></a>
<br>and:
<a href="https://www.codecogs.com/eqnedit.php?latex=\overrightarrow{w}_{t&plus;1}&space;=&space;\begin{matrix}&space;&&space;\text{argmin&space;}&space;\frac{1}{2}\left&space;\|&space;w-{w_{t}}&space;\right&space;\|^2&space;\text{&space;s.t.&space;}&space;\mathit{l}(\overrightarrow{w};(\overrightarrow{x},y))=&space;0&space;\\&space;&&space;_{\overrightarrow{w}\,\epsilon&space;\,&space;\mathbb{R}^{n}}&space;\end{matrix}" target="_blank"><img src="https://latex.codecogs.com/svg.latex?\overrightarrow{w}_{t&plus;1}&space;=&space;\begin{matrix}&space;&&space;\text{argmin&space;}&space;\frac{1}{2}\left&space;\|&space;w-{w_{t}}&space;\right&space;\|^2&space;\text{&space;s.t.&space;}&space;\mathit{l}(\overrightarrow{w};(\overrightarrow{x},y))=&space;0&space;\\&space;&&space;_{\overrightarrow{w}\,\epsilon&space;\,&space;\mathbb{R}^{n}}&space;\end{matrix}" title="\overrightarrow{w}_{t+1} = \begin{matrix} & \text{argmin } \frac{1}{2}\left \| w-{w_{t}} \right \|^2 \text{ s.t. } \mathit{l}(\overrightarrow{w};(\overrightarrow{x},y))= 0 \\ & _{\overrightarrow{w}\,\epsilon \, \mathbb{R}^{n}} \end{matrix}" /></a>
<br>
Use Lagrange multipliers to get:<br>
<a href="https://www.codecogs.com/eqnedit.php?latex=\\&space;f(\overrightarrow{w})=\frac{1}{2}\left&space;\|&space;w&space;\right&space;\|^2-\overrightarrow{w}\cdot&space;\overrightarrow{w}_t&plus;\frac{1}{2}\left&space;\|&space;w_t&space;\right&space;\|^2&space;\\&space;g(\overrightarrow{w})=&space;y_t(\overrightarrow{w}\cdot&space;\overrightarrow{x_t})-1&space;=&space;0" target="_blank"><img src="https://latex.codecogs.com/svg.latex?\\&space;f(\overrightarrow{w})=\frac{1}{2}\left&space;\|&space;w&space;\right&space;\|^2-\overrightarrow{w}\cdot&space;\overrightarrow{w}_t&plus;\frac{1}{2}\left&space;\|&space;w_t&space;\right&space;\|^2&space;\\&space;g(\overrightarrow{w})=&space;y_t(\overrightarrow{w}\cdot&space;\overrightarrow{x_t})-1&space;=&space;0" title="\\ f(\overrightarrow{w})=\frac{1}{2}\left \| w \right \|^2-\overrightarrow{w}\cdot \overrightarrow{w}_t+\frac{1}{2}\left \| w_t \right \|^2 \\ g(\overrightarrow{w})= y_t(\overrightarrow{w}\cdot \overrightarrow{x_t})-1 = 0" /></a>
<br>
<a href="https://www.codecogs.com/eqnedit.php?latex=\emph{L}(\overrightarrow{w},\tau)&space;=&space;f(\overrightarrow{w})&space;-&space;\tau&space;\cdot&space;g(\overrightarrow{w}))&space;=&space;\frac{1}{2}\left&space;\|w\right&space;\|^2-\overrightarrow{w}\cdot\overrightarrow{w_t}&plus;\frac{1}{2}\left&space;\|w_t\right&space;\|^2&space;-&space;\tau&space;\cdot&space;y_t&space;\cdot(\overrightarrow{w}\cdot&space;\overrightarrow{x_t})&plus;\tau" target="_blank"><img src="https://latex.codecogs.com/svg.latex?\emph{L}(\overrightarrow{w},\tau)&space;=&space;f(\overrightarrow{w})&space;-&space;\tau&space;\cdot&space;g(\overrightarrow{w}))&space;=&space;\frac{1}{2}\left&space;\|w\right&space;\|^2-\overrightarrow{w}\cdot\overrightarrow{w_t}&plus;\frac{1}{2}\left&space;\|w_t\right&space;\|^2&space;-&space;\tau&space;\cdot&space;y_t&space;\cdot(\overrightarrow{w}\cdot&space;\overrightarrow{x_t})&plus;\tau" title="\emph{L}(\overrightarrow{w},\tau) = f(\overrightarrow{w}) - \tau \cdot g(\overrightarrow{w})) = \frac{1}{2}\left \|w\right \|^2-\overrightarrow{w}\cdot\overrightarrow{w_t}+\frac{1}{2}\left \|w_t\right \|^2 - \tau \cdot y_t \cdot(\overrightarrow{w}\cdot \overrightarrow{x_t})+\tau" /></a>
<br>
<a href="https://www.codecogs.com/eqnedit.php?latex=\nabla\emph{L}(\overrightarrow{w},\tau)=\nablaf(\overrightarrow{w})&space;-&space;\tau&space;\cdot&space;\nabla&space;g(\overrightarrow{w})&space;=&space;0" target="_blank"><img src="https://latex.codecogs.com/svg.latex?\nabla\emph{L}(\overrightarrow{w},\tau)=\nablaf(\overrightarrow{w})&space;-&space;\tau&space;\cdot&space;\nabla&space;g(\overrightarrow{w})&space;=&space;0" title="\nabla\emph{L}(\overrightarrow{w},\tau)=\nablaf(\overrightarrow{w}) - \tau \cdot \nabla g(\overrightarrow{w}) = 0" /></a>
<br>
<a href="https://www.codecogs.com/eqnedit.php?latex=\\&space;\nabla\emph{L}(\overrightarrow{w},\tau)=\nabla&space;f(\overrightarrow{w})&space;-&space;\tau&space;\cdot&space;\nabla&space;g(\overrightarrow{w})&space;=&space;0&space;\\&space;\frac{\partial}{\partial&space;\overrightarrow{w}}\emph{L}(\overrightarrow{w},\tau)=\overrightarrow{w}-\overrightarrow{w_t}-\tau&space;\cdot&space;y_t&space;\cdot&space;\overrightarrow{x_t}=0&space;\\&space;\frac{\partial}{\partial&space;\tau}\emph{L}(\overrightarrow{w},\tau)=&space;-y_t&space;\cdot&space;(\overrightarrow{w}&space;\cdot&space;\overrightarrow{x_t})&space;&plus;&space;1=0&space;\\&space;\\&space;\overrightarrow{w}&space;=&space;\frac{1}{y_t&space;\cdot&space;\overrightarrow{x_t}}&space;\;&space;\;&space;\;&space;\;&space;\;&space;\;&space;\tau&space;=&space;\frac{\overrightarrow{w}-\overrightarrow{w_t}}{y_t&space;\cdot&space;\overrightarrow{x_t}}" target="_blank"><img src="https://latex.codecogs.com/svg.latex?\\&space;\nabla\emph{L}(\overrightarrow{w},\tau)=\nabla&space;f(\overrightarrow{w})&space;-&space;\tau&space;\cdot&space;\nabla&space;g(\overrightarrow{w})&space;=&space;0&space;\\&space;\frac{\partial}{\partial&space;\overrightarrow{w}}\emph{L}(\overrightarrow{w},\tau)=\overrightarrow{w}-\overrightarrow{w_t}-\tau&space;\cdot&space;y_t&space;\cdot&space;\overrightarrow{x_t}=0&space;\\&space;\frac{\partial}{\partial&space;\tau}\emph{L}(\overrightarrow{w},\tau)=&space;-y_t&space;\cdot&space;(\overrightarrow{w}&space;\cdot&space;\overrightarrow{x_t})&space;&plus;&space;1=0&space;\\&space;\\&space;\overrightarrow{w}&space;=&space;\frac{1}{y_t&space;\cdot&space;\overrightarrow{x_t}}&space;\;&space;\;&space;\;&space;\;&space;\;&space;\;&space;\tau&space;=&space;\frac{\overrightarrow{w}-\overrightarrow{w_t}}{y_t&space;\cdot&space;\overrightarrow{x_t}}" title="\\ \nabla\emph{L}(\overrightarrow{w},\tau)=\nabla f(\overrightarrow{w}) - \tau \cdot \nabla g(\overrightarrow{w}) = 0 \\ \frac{\partial}{\partial \overrightarrow{w}}\emph{L}(\overrightarrow{w},\tau)=\overrightarrow{w}-\overrightarrow{w_t}-\tau \cdot y_t \cdot \overrightarrow{x_t}=0 \\ \frac{\partial}{\partial \tau}\emph{L}(\overrightarrow{w},\tau)= -y_t \cdot (\overrightarrow{w} \cdot \overrightarrow{x_t}) + 1=0 \\ \\ \overrightarrow{w} = \frac{1}{y_t \cdot \overrightarrow{x_t}} \; \; \; \; \; \; \tau = \frac{\overrightarrow{w}-\overrightarrow{w_t}}{y_t \cdot \overrightarrow{x_t}}" /></a>
<br>
<a href="https://www.codecogs.com/eqnedit.php?latex=\tau_t&space;=&space;\frac{\frac{1}{y_t&space;\cdot&space;\overrightarrow{x_t}}-\overrightarrow{w_t}&space;}{y_t&space;\cdot&space;\overrightarrow{x_t}}&space;=&space;\frac{\frac{1-y_t&space;\cdot(\overrightarrow{w_t}&space;\cdot&space;\overrightarrow{x_t})}{y_t&space;\cdot&space;\overrightarrow{x_t}}}{y_t&space;\cdot&space;\overrightarrow{x_t}}&space;=&space;\frac{1-y_t&space;\cdot(\overrightarrow{w_t}&space;\cdot&space;\overrightarrow{x_t})}{y_t&space;\cdot&space;y_t&space;\cdot&space;\overrightarrow{x_t}&space;\cdot&space;\overrightarrow{x_t}}=&space;\frac{\mathit{l_t}(\overrightarrow{w_t};(\overrightarrow{x_t},y_t))}{\left&space;\|&space;x_t&space;\right&space;\|^2}&space;=&space;\frac{\mathit{l_t}}{\left&space;\|&space;x_t&space;\right&space;\|^2}" target="_blank"><img src="https://latex.codecogs.com/gif.latex?\tau_t&space;=&space;\frac{\frac{1}{y_t&space;\cdot&space;\overrightarrow{x_t}}-\overrightarrow{w_t}&space;}{y_t&space;\cdot&space;\overrightarrow{x_t}}&space;=&space;\frac{\frac{1-y_t&space;\cdot(\overrightarrow{w_t}&space;\cdot&space;\overrightarrow{x_t})}{y_t&space;\cdot&space;\overrightarrow{x_t}}}{y_t&space;\cdot&space;\overrightarrow{x_t}}&space;=&space;\frac{1-y_t&space;\cdot(\overrightarrow{w_t}&space;\cdot&space;\overrightarrow{x_t})}{y_t&space;\cdot&space;y_t&space;\cdot&space;\overrightarrow{x_t}&space;\cdot&space;\overrightarrow{x_t}}=&space;\frac{\mathit{l_t}(\overrightarrow{w_t};(\overrightarrow{x_t},y_t))}{\left&space;\|&space;x_t&space;\right&space;\|^2}&space;=&space;\frac{\mathit{l_t}}{\left&space;\|&space;x_t&space;\right&space;\|^2}" title="\tau_t = \frac{\frac{1}{y_t \cdot \overrightarrow{x_t}}-\overrightarrow{w_t} }{y_t \cdot \overrightarrow{x_t}} = \frac{\frac{1-y_t \cdot(\overrightarrow{w_t} \cdot \overrightarrow{x_t})}{y_t \cdot \overrightarrow{x_t}}}{y_t \cdot \overrightarrow{x_t}} = \frac{1-y_t \cdot(\overrightarrow{w_t} \cdot \overrightarrow{x_t})}{y_t \cdot y_t \cdot \overrightarrow{x_t} \cdot \overrightarrow{x_t}}= \frac{\mathit{l_t}(\overrightarrow{w_t};(\overrightarrow{x_t},y_t))}{\left \| x_t \right \|^2} = \frac{\mathit{l_t}}{\left \| x_t \right \|^2}" /></a>


... to be continued ...

It's by far not complete, so anybody who wants to contribute or correct things is more than welcome.



Further material to this subject can be found here: 

https://papers.nips.cc/paper/2360-online-passive-aggressive-algorithms.pdf

https://www.youtube.com/watch?v=O0a-m2d_L58  

https://www.youtube.com/watch?v=uxGDwyPWNkU

https://www.youtube.com/watch?v=TJU8NfDdqNQ

https://link.springer.com/chapter/10.1007/978-3-642-53917-6_32

https://arxiv.org/pdf/1808.06107.pdf

https://www.bonaccorso.eu/2017/10/06/ml-algorithms-addendum-passive-aggressive-algorithms/

https://link.springer.com/chapter/10.1007/978-3-642-41491-6_12

https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.PassiveAggressiveClassifier.html
